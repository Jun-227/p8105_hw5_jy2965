p8105\_hw5\_jy2965
================
Jun Yin
11/8/2019

## Problem 1

``` r
set.seed(10)
iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

``` r
#build the function
replace_na_fun = function(vec) {
  
  if (is.numeric(vec)) {
    vec[is.na(vec)] = mean(vec, na.rm = TRUE)
  } else if (is.character(vec)) {
    vec[is.na(vec)] = "virginica"
  } 
  
 vec
}
#using the function with for loop
iris_noneed = vector("list", length = 5)
for (i in 1:5) {
  
  iris_noneed[[i]] = replace_na_fun(iris_with_missing[[i]])
  
}
 
# Apply this function to the columns of iris_with_missing using a map statement
iris_without_missing = map_df(iris_with_missing,replace_na_fun) 
```

I replaeced missiong value based on the instruction and generated a new
dataset named
    iris\_withou\_missing.

## Problem 2

``` r
ldply(.data = "./data/hw5_data.zip", .fun = unzip, exdir= "./")
```

    ##                   V1                            V2                 V3
    ## 1 .//data/exp_05.csv .//__MACOSX/data/._exp_05.csv .//data/exp_04.csv
    ##                              V4                 V5
    ## 1 .//__MACOSX/data/._exp_04.csv .//data/exp_10.csv
    ##                              V6                 V7
    ## 1 .//__MACOSX/data/._exp_10.csv .//data/exp_06.csv
    ##                              V8                 V9
    ## 1 .//__MACOSX/data/._exp_06.csv .//data/exp_07.csv
    ##                             V10                V11
    ## 1 .//__MACOSX/data/._exp_07.csv .//data/exp_03.csv
    ##                             V12                V13
    ## 1 .//__MACOSX/data/._exp_03.csv .//data/exp_02.csv
    ##                             V14                V15
    ## 1 .//__MACOSX/data/._exp_02.csv .//data/exp_01.csv
    ##                             V16                V17
    ## 1 .//__MACOSX/data/._exp_01.csv .//data/con_06.csv
    ##                             V18                V19
    ## 1 .//__MACOSX/data/._con_06.csv .//data/con_07.csv
    ##                             V20                V21
    ## 1 .//__MACOSX/data/._con_07.csv .//data/con_05.csv
    ##                             V22                V23
    ## 1 .//__MACOSX/data/._con_05.csv .//data/con_10.csv
    ##                             V24                V25
    ## 1 .//__MACOSX/data/._con_10.csv .//data/con_04.csv
    ##                             V26                V27
    ## 1 .//__MACOSX/data/._con_04.csv .//data/con_01.csv
    ##                             V28                V29
    ## 1 .//__MACOSX/data/._con_01.csv .//data/con_03.csv
    ##                             V30                V31
    ## 1 .//__MACOSX/data/._con_03.csv .//data/con_02.csv
    ##                             V32                V33
    ## 1 .//__MACOSX/data/._con_02.csv .//data/con_09.csv
    ##                             V34                V35
    ## 1 .//__MACOSX/data/._con_09.csv .//data/con_08.csv
    ##                             V36                V37
    ## 1 .//__MACOSX/data/._con_08.csv .//data/exp_09.csv
    ##                             V38                V39
    ## 1 .//__MACOSX/data/._exp_09.csv .//data/exp_08.csv
    ##                             V40                V41
    ## 1 .//__MACOSX/data/._exp_08.csv .//__MACOSX/._data

``` r
pb2_data = as.data.frame(list.files(path = "./data/", pattern = "*.csv")) 
colnames(pb2_data)[1] = "file_names"
read_and_tidy = function(file_names){
     read.csv(str_c("./data/", file_names)) 
}
pb2_tidy_data = 
  mutate(pb2_data,subject_data = map(pb2_data$file_names, read_and_tidy)) %>% 
  unnest(subject_data) %>% 
  separate(file_names, into = c("group", "id"), sep = "_") %>% 
  mutate(id = sapply(id, substring, 1,2))

## spagehtti plot
  graph_plot=
    pb2_tidy_data %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "results"
  ) %>% 
   mutate(week_number = sapply(week, substring, 6,6))
  graph_plot %>% 
  ggplot(aes(x = week_number, y = results, group = id, color = id)) +
  geom_line() +
  facet_grid(~ group) +
  labs(
    title = "Observations on Each Subject over Time",
    x = "Week",
    y = "results",
    caption = "Data from a longitudinal study") +
    theme(legend.position = "bottom")
```

<img src="p8105_hw5_jy2965_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

As we can see from the graph, the results of control group don’t have
any increasing or decreasing trend over 8 weeks, but the results of
experiment group increased through 8 weeks. At the beginning of the
experiment, the mean of the results of control group is 0.915, and the
mean of the value of experiment group is 1.141, which are almost the
same. However, the value of the experiment group significantly increased
over this 8-weeks study, whereas the control group didn’t change a lot
(actually decreased a little bit). At the end of this study, the mean
value of the control group is 0.74, and the mean value of the experiment
group is 5.119.
